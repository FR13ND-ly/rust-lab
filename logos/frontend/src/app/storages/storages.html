<div class="bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col overflow-hidden">
  <div class="shrink-0 p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50">
    <h2 class="font-bold text-slate-700 flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4" />
        <path d="M4 6v12c0 1.1.9 2 2 2h14v-4" />
        <path d="M18 12a2 2 0 0 0-2 2c0 1.1.9 2 2 2h4v-4h-4z" />
      </svg>
      Storages
    </h2>
  </div>

  <div class="flex-1 overflow-y-auto p-4 min-h-0">
    <div class="flex gap-2 mb-4 shrink-0 w-full">
      <input type="text" [(ngModel)]="newStorageName" (keyup.enter)="create()" placeholder="New Storage Name..."
        class="flex-1 px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
    </div>

    <div class="space-y-2">
      @for (s of service.storages(); track s.id) {
      <div (click)="service.joinStorage(s.id)" [class.ring-2]="service.activeStorageId() === s.id"
        class="ring-blue-500 ring-offset-1 p-3 rounded-lg border border-slate-200 hover:border-blue-400 hover:bg-blue-50 cursor-pointer transition-all group relative">

        <div class="flex justify-between items-center pr-8">
          <span class="font-medium text-slate-700 group-hover:text-blue-700">{{ s.name }}</span>
        </div>
        <div class="flex items-center gap-2 mt-1">
          <div class="text-xs text-slate-400 font-mono truncate max-w-40">{{ s.id }}</div>
          <button (click)="$event.stopPropagation(); copyId(s.id)" title="Copy ID"
            class="text-slate-300 hover:text-blue-500">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
            </svg>
          </button>
        </div>

        <button (click)="$event.stopPropagation(); delete(s.id)"
          class="absolute right-2 top-3 p-1.5 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded transition-colors opacity-0 group-hover:opacity-100"
          title="Delete Storage">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="3 6 5 6 21 6" />
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
            <line x1="10" y1="11" x2="10" y2="17" />
            <line x1="14" y1="11" x2="14" y2="17" />
          </svg>
        </button>
      </div>
      } @empty {
      <div class="text-center py-6 text-slate-400 text-sm">
        No storages found.
      </div>
      }
    </div>
  </div>
</div>